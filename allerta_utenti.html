<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Allerta Meteo Basilicata</title>
<script>
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyD1ABRI99tMtvFbbvjqyjbLImfgNMdRR28",
  authDomain: "bollettinoregionale.firebaseapp.com",
  projectId: "bollettinoregionale",
  storageBucket: "bollettinoregionale.firebasestorage.app",
  messagingSenderId: "765538370497",
  appId: "1:765538370497:web:9c4f569754c0df01cc2540",
  measurementId: "G-0BCQ0VRNXF"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const analytics = getAnalytics(app);
<script>


    <style>
        body {
            font-family: sans-serif;
        }
        .alert-display {
            max-width: 600px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 3px;
            box-sizing: border-box;
        }
        .alert-color {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .verde { background-color: green; }
        .giallo { background-color: yellow; color: black; }
        .arancione { background-color: orange; }
        .rosso { background-color: red; }
        #alertResults {
            margin-top: 20px;
            border-top: 1px solid #eee;
            padding-top: 20px;
        }
        #alertResults h2 {
            margin-top: 0;
        }
    </style>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.10.0/firebase-database-compat.js"></script>
</head>
<body>

    <div class="alert-display">
        <h1>Allerta Meteo Basilicata</h1>

        <label for="comune">Seleziona il tuo Comune:</label>
        <select id="comune">
            <option value="">-- Seleziona un Comune --</option>
            <optgroup label="Base A1">
                <option value="Montemilone">Montemilone</option>
                <option value="Atella">Atella</option>
                <option value="PalazzoSanGervasio">Palazzo San Gervasio</option>
                <option value="Pescopagano">Pescopagano</option>
                <option value="Rapolla">Rapolla</option>
                <option value="Rapone">Rapone</option>
                <option value="RioneroinVulture">Rionero in Vulture</option>
                <option value="Ripacandida">Ripacandida</option>
                <option value="RuvodelMonte">Ruvo del Monte</option>
                <option value="SanFele">San Fele</option>
                <option value="Filiano_A1">Filiano</option>
                <option value="Forenza_A1">Forenza</option>
                <option value="Lavello">Lavello</option>
                <option value="Barile">Barile</option>
                <option value="Maschito">Maschito</option>
                <option value="Melfi">Melfi</option>
                <option value="Venosa">Venosa</option>
                <option value="Ginestra">Ginestra</option>
            </optgroup>
            <optgroup label="Base A2">
                <option value="MuroLucano">Muro Lucano</option>
                <option value="Balvano">Balvano</option>
                <option value="Baragiano">Baragiano</option>
                <option value="Bella">Bella</option>
                <option value="Brienza">Brienza</option>
                <option value="Castelgrande">Castelgrande</
                <option value="Brienza">Brienza</option>
                <option value="Castelgrande">Castelgrande</option>
                <option value="Picerno">Picerno</option>
                <option value="Ruoti">Ruoti</option>
                <option value="SantAngeloLeFratte">Sant'Angelo Le Fratte</option>
                <option value="SassodiCastalda">Sasso di Castalda</option>
                <option value="SatrianodiLucania">Satriano di Lucania</option>
                <option value="SavoiadiLucania">Savoia di Lucania</option>
                <option value="Tito_A2">Tito</option>
                <option value="VietridiPotenza">Vietri di Potenza</option>
            </optgroup>
            <optgroup label="Base B">
                <option value="Abriola">Abriola</option>
                <option value="Accettura">Accettura</option>
                <option value="Acerenza">Acerenza</option>
                <option value="AlbanodiLucania">Albano di Lucania</option>
                <option value="Anzi">Anzi</option>
                <option value="Avigliano">Avigliano</option>
                <option value="Banzi">Banzi</option>
                <option value="BrindisiMontagna">Brindisi Montagna</option>
                <option value="Calciano">Calciano</option>
                <option value="Calvello">Calvello</option>
                <option value="Campomaggiore">Campomaggiore</option>
                <option value="Cancellara">Cancellara</option>
                <option value="Castelmezzano">Castelmezzano</option>
                <option value="Ferrandina_B">Ferrandina</option>
                <option value="Filiano_B">Filiano</option>
                <option value="Forenza_B">Forenza</option>
                <option value="Garaguso">Garaguso</option>
                <option value="GenzanodiLucania">Genzano di Lucania</option>
                <option value="Grassano">Grassano</option>
                <option value="Grottole">Grottole</option>
                <option value="Irsina">Irsina</option>
                <option value="Laurenzana">Laurenzana</option>
                <option value="Miglionico">Miglionico</option>
                <option value="OlivetoLucano">Oliveto Lucano</option>
                <option value="OppidoLucano">Oppido Lucano</option>
                <option value="Pietragalla">Pietragalla</option>
                <option value="Pietrapertosa">Pietrapertosa</option>
                <option value="Pignola">Pignola</option>
                <option value="Pomarico_B">Pomarico</option>
                <option value="Potenza">Potenza</option>
                <option value="Salandra">Salandra</option>
                <option value="SanChiricoNuovo">San Chirico Nuovo</option>
                <option value="SanMauroForte">San Mauro Forte</option>
                <option value="Tito_B">Tito</option>
                <option value="Tolve">Tolve</option>
                <option value="Tricarico">Tricarico</option>
                <option value="Trivigno">Trivigno</option>
                <option value="VaglioBasilicata">Vaglio Basilicata</option>
                <option value="Matera">Matera</option>
            </optgroup>
            <optgroup label="Base C">
                <option value="Montemurro">Montemurro</option>
                <option value="Aliano">Aliano</option>
                <option value="Armento">Armento</option>
                <option value="Calvera">Calvera</option>
                <option value="Carbone">Carbone</option>
                <option value="CastronuovodiSantAndrea">Castronuovo di Sant'Andrea</option>
                <option value="Cersosimo">Cersosimo</option>
                <option value="Chiaromonte">Chiaromonte</option>
                <option value="Cirigliano">Cirigliano</option>
                <option value="Colobraro">Colobraro</option>
                <option value="CorletoPerticara">Corleto Perticara</option>
                <option value="Episcopia">Episcopia</option>
                <option value="Fardella">Fardella</option>
                <option value="FrancavillainSinni">Francavilla in Sinni</option>
                <option value="Gallicchio">Gallicchio</option>
                <option value="Gorgoglione">Gorgoglione</option>
                <option value="GrumentoNova">Grumento Nova</option>
                <option value="GuardiaPerticara">Guardia Perticara</option>
                <option value="MarsicoNuovo">Marsico Nuovo</option>
                <option value="Marsicovetere">Marsicovetere</option>
                <option value="Missanello">Missanello</option>
                <option value="Moliterno">Moliterno</option>
                <option value="Noepoli">Noepoli</option>
                <option value="Paterno">Paterno</option>
                <option value="Roccanova">Roccanova</option>
                <option value="SanChiricoRaparo">San Chirico Raparo</option>
                <option value="SanCostantinoAlbanese">San Costantino Albanese</option>
                <option value="SanGiorgioLucano">San Giorgio Lucano</option>
                <option value="SanMartinodAgri">San Martino d'Agri</option>
                <option value="SanPaoloAlbanese">San Paolo Albanese</option>
                <option value="SanSeverinoLucano">San Severino Lucano</option>
                <option value="SantArcangelo">Sant'Arcangelo</option>
                <option value="Sarconi">Sarconi</option>
                <option value="Senise">Senise</option>
                <option value="Spinoso">Spinoso</option>
                <option value="Stigliano">Stigliano</option>
                <option value="Teana">Teana</option>
                <option value="TerranovadiPollino">Terranova di Pollino</option>
                <option value="Tramutola">Tramutola</option>
                <option value="Tursi_C">Tursi</option>
                <option value="Valsinni">Valsinni</option>
                <option value="Viggiano">Viggiano</option>
            </optgroup>
            <optgroup label="Base D">
                <option value="Nemoli">Nemoli</option>
                <option value="CastelluccioInferiore">Castelluccio Inferiore</option>
                <option value="CastelluccioSuperiore">Castelluccio Superiore</option>
                <option value="Castelsaraceno">Castelsaraceno</option>
                <option value="Lagonegro">Lagonegro</option>
                <option value="Latronico">Latronico</option>
                <option value="Lauria">Lauria</option>
                <option value="Maratea">Maratea</option>
                <option value="Rivello">Rivello</option>
                <option value="Rotonda">Rotonda</option>
                <option value="Trecchina">Trecchina</option>
                <option value="Viggianello_D">Viggianello</option>
            </optgroup>
            <optgroup label="Base E1">
                <option value="NovaSiri">Nova Siri</option>
                <option value="Policoro">Policoro</option>
                <option value="Rotondella_E1">Rotondella</option>
                <option value="ScanzanoJonico">Scanzano Jonico</option>
                <option value="Tursi_E1">Tursi</option>
                <option value="MontalbanoJonico">Montalbano Jonico</option>
                <option value="Craco">Craco</option>
            </optgroup>
            <optgroup label="Base E2">
                <option value="Montescaglioso">Montescaglioso</option>
                <option value="Bernalda">Bernalda</option>
                <option value="Pisticci">Pisticci</option>
                <option value="Pomarico_E2">Pomarico</option>
                <option value="Ferrandina_E2">Ferrandina</option>
            </optgroup>
            <option value="all">Tutta la Regione</option>
            <option value="A1_base">Base A1</option>
            <option value="A2_base">Base A2</option>
            <option value="B_base">Base B</option>
            <option value="C_base">Base C</option>
            <option value="D_base">Base D</option>
            <option value="E1_base">Base E1</option>
            <option value="E2_base">Base E2</option>
        </select>

        <div id="alertResults">
            <h2>Allerta Meteo per <span id="selectedLocation"></span></h2>
            <h3>Oggi - <span id="oggiData"></span></h3>
            <p id="oggiAlert"></p>
            <h3>Domani - <span id="domaniData"></span></h3>
            <p id="domaniAlert"></p>
        </div>
    </div>

    <script>
     // Initialize Firebase
		const firebaseConfig = {
			apiKey: "INSERISCI_LA_TUA_API_KEY",
			authDomain: "INSERISCI_IL_TUO_PROJECT_ID.firebaseapp.com",
			databaseURL: "https://INSERISCI_IL_TUO_PROJECT_ID-default-rtdb.europe-west1.firebasedatabase.app",
			projectId: "INSERISCI_IL_TUO_PROJECT_ID",
			storageBucket: "INSERISCI_IL_TUO_PROJECT_ID.appspot.com",
			messagingSenderId: "INSERISCI_IL_TUO_MESSAGING_SENDER_ID",
			appId: "INSERISCI_IL_TUO_APP_ID",
			measurementId: "INSERISCI_IL_TUO_MEASUREMENT_ID"
		};

		firebase.initializeApp(firebaseConfig);

		const database = firebase.database();

        document.addEventListener('DOMContentLoaded', function() {
            // Imposta le date di oggi e domani
            const oggi = new Date();
            const domani = new Date(oggi);
            domani.setDate(oggi.getDate() + 1);

            document.getElementById('oggiData').innerText = formatDate(oggi);
            document.getElementById('domaniData').innerText = formatDate(domani);

            function formatDate(date) {
                const day = date.getDate().toString().padStart(2, '0');
                const month = (date.getMonth() + 1).toString().padStart(2, '0');
                const year = date.getFullYear();
                return `${day}/${month}/${year}`;
            }

            function mostraAllerta() {
                const comuneSelezionato = document.getElementById("comune").value;
                const selectedLocationElement = document.getElementById("selectedLocation");
                const oggiAlertElement = document.getElementById("oggiAlert");
                const domaniAlertElement = document.getElementById("domaniAlert");

                let oggiColor = "";
                let domaniColor = "";
                let baseComune = "";

                const oggiData = document.getElementById('oggiData').innerText;
                const domaniData = document.getElementById('domaniData').innerText;

                if (comuneSelezionato === "all") {
                    selectedLocationElement.textContent = "Tutta la Regione";
                    oggiAlertElement.innerHTML = `
                        Base A1: <span class="alert-color"></span><br>
                        Base A2: <span class="alert-color"></span><br>
                        Base B: <span class="alert-color"></span><br>
                        Base C: <span class="alert-color"></span><br>
                        Base D: <span class="alert-color"></span><br>
                        Base E1: <span class="alert-color"></span><br>
                        Base E2: <span class="alert-color"></span>
                    `;
                    domaniAlertElement.innerHTML = `
                        Base A1: <span class="alert-color"></span><br>
                        Base A2: <span class="alert-color"></span><br>
                        Base B: <span class="alert-color"></span><br>
                        Base C: <span class="alert-color"></span><br>
                        Base D: <span class="alert-color"></span><br>
                        Base E1: <span class="alert-color"></span><br>
                        Base E2: <span class="alert-color"></span>
                    `;
                } else if (comuneSelezionato.endsWith("_base")) {
                    const base = comuneSelezionato.split("_")[0];
                    selectedLocationElement.textContent = `Base ${base}`;
                    oggiAlertElement.innerHTML = `<span class="alert-color"></span>`;
                    domaniAlertElement.innerHTML = `<span class="alert-color"></span>`;
                } else {
                    selectedLocationElement.textContent = comuneSelezionato.replace(/_A1|_A2|_B|_C|_D|_E1|_E2/g, '');
                    oggiAlertElement.innerHTML = `<span class="alert-color"></span>`;
                    domaniAlertElement.innerHTML = `<span class="alert-color"></span>`;
                }
            }

            function getColorText(color) {
                switch (color) {
                    case "verde":
                        return "Nessuna allerta specifica.";
                    case "giallo":
                        return "Possibili criticità idrogeologiche localizzate.";
                    case "arancione":
                        return "Possibili fenomeni intensi con criticità idrogeologica diffusa.";
                    case "rosso":
                        return "Elevata criticità per rischio idrogeologico e idraulico.";
                    default:
                        return "Nessuna informazione sull'allerta.";
                }
            }

            // Listener for Realtime Database changes
            database.ref('allerte').on('value', (snapshot) => {
                const allerte = snapshot.val();
                if (allerte) {
                    localStorage.setItem('allerteOggi', JSON.stringify(allerte[document.getElementById('oggiData').innerText] || {}));
                    localStorage.setItem('allerteDomani', JSON.stringify(allerte[document.getElementById('domaniData').innerText] || {}));
                }
                mostraAllerta(); // Update display after data is fetched
            });

            // Inizializza la visualizzazione all'avvio della pagina
            mostraAllerta();

            document.getElementById("comune").addEventListener("change", mostraAllerta);
        });
    </script>

</body>
</html>
